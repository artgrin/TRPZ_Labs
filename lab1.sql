
USE master;
DROP DATABASE IF EXISTS UNIVERSITY_DB;

CREATE DATABASE USERDB;
GO  
ALTER DATABASE USERDB SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
GO
ALTER DATABASE USERDB MODIFY NAME = UNIVERSITY_DB;
GO  
ALTER DATABASE UNIVERSITY_DB SET MULTI_USER;
GO
USE UNIVERSITY_DB;
GO

EXEC sp_helpdb UNIVERSITY_DB;

CREATE TABLE DcSubdivision
(
    DcSubdivisionId INT PRIMARY KEY IDENTITY,
    Name VARCHAR(250) NOT NULL
);

CREATE TABLE StudyGroup
(
    StudyGroupId INT PRIMARY KEY IDENTITY,
    Name VARCHAR(250) NOT NULL,
	DcSubdivisionId INT NOT NULL,
	DataVstup DATE,
	CONSTRAINT FK_StudyGroup_DcSubdivision FOREIGN KEY (DcSubdivisionId)  REFERENCES DcSubdivision (DcSubdivisionId)
);

CREATE TABLE Student
(
    StudentId INT PRIMARY KEY IDENTITY,
	Surname VARCHAR(20) NOT NULL,
    Name VARCHAR(15) NOT NULL,
	Patronymic VARCHAR(20),
	Birthday DATE NOT NULL,
	RecordBook VARCHAR(10) NOT NULL,
	BirthdayCity VARCHAR(10),
	StudyGroupId INT NOT NULL,
	Stipendiya MONEY,
	CONSTRAINT FKStudyGroupStudent FOREIGN KEY (StudyGroupId)  REFERENCES StudyGroup (StudyGroupId)
);

CREATE TABLE DcDuties
(
	DcDutiesId INT PRIMARY KEY IDENTITY,
	Name VARCHAR(50) NOT NULL,
	DcSubdivisionId INT,
	CONSTRAINT FK_DcDuties_DcSubdivision FOREIGN KEY (DcSubdivisionId)  REFERENCES DcSubdivision (DcSubdivisionId)
);

CREATE TABLE Employee
(
	EmployeeId INT PRIMARY KEY IDENTITY,
	Surname VARCHAR(20) NOT NULL,
    Name VARCHAR(15) NOT NULL,
	Patronymic VARCHAR(20),
	Oklad MONEY NOT NULL,
	BirthdayCity VARCHAR(10),
	Nadbavka MONEY,
	DataVyplatu DATE,
	DcDutiesId INT,
	Birthday DATE,
	CONSTRAINT FK_Employee_DcDuties FOREIGN KEY (DcDutiesId)  REFERENCES DcDuties (DcDutiesId)
);

CREATE TABLE DcDiscipline
(
	DcDisciplineId INT PRIMARY KEY IDENTITY,
    Name VARCHAR(250) NOT NULL
);

CREATE TABLE Exam
(
	ExamId INT PRIMARY KEY IDENTITY,
	Mark INT NOT NULL,
	DateExam DATE NOT NULL,
	StudentId INT,
	DcDisciplineId INT,
	EmployeeId INT,
	CONSTRAINT FKStudentExam FOREIGN KEY (StudentId)  REFERENCES Student (StudentId),
	CONSTRAINT FKDcDisciplineExam FOREIGN KEY (DcDisciplineId)  REFERENCES DcDiscipline (DcDisciplineId),
	CONSTRAINT FKEmployeeExam FOREIGN KEY (EmployeeId)  REFERENCES Employee (EmployeeId)
);

ALTER TABLE DcSubdivision ADD actualite Varchar(20) NULL;

--SELECT * FROM sysobjects WHERE type = 'U';

--DELETE DcDiscipline;


INSERT INTO DcDiscipline(Name) VALUES
('Математика'),
('Фізика'),
('Хімія'),
('Англійська'),
('Історія'),
('Право'),
('Економіка'),
('Французька');

INSERT INTO DcSubdivision(Name) VALUES
('Кафедра 1'),
('Кафедра 2'),
('Управління 1'),
('Управління 2'),
('Сектор 1'),
('Сектор 2'),
('Департамент 1'),
('Відділ 1');

INSERT INTO DcDuties (Name,DcSubdivisionID) VALUES
('Доцент','1'),
('Асистент','1'),
('Професор','1'),
('Методист','8'),
('Інспектор','8'),
('Керівник','7'),
('Лаборант','5'),
('Доцент','2'),
('Доцент','2'),
('Доцент','2'),
('Лаборант старший','6');

INSERT INTO StudyGroup(Name,DcSubdivisionID) VALUES
('ІК-11','1'),
('ІК-12','1'),
('ІК-23','2'),
('ІК-24','2');

SET IDENTITY_INSERT Student OFF;
SET IDENTITY_INSERT Employee ON;

INSERT INTO Employee(EmployeeId,Surname,Name,Patronymic,DcDutiesId,Birthday,BirthdayCity,Oklad,Nadbavka,DataVyplatu) VALUES
('1','Петренко','Максим','Леонидович','1','1954-03-23','Киев','4000.5666','300.00','1954-03-23'),
('2','Новиков','Степан','Федорович','1','1955-04-21','Киев','1400.061','256.00','1955-04-21'),
('3','Бобков','Виктор','Борисович','2','1965-06-14','Львов','4000.0598','123.00','1965-06-14'),
('4','Ванжула','Оксана','Петровна','2','1945-02-12','Киев','3200.4657','456.00','1945-02-12'),
('5','Мацуки','Йоши','','3','1978-07-07','Москва','2000.00','789.00','1978-07-07'),
('6','Петренко','Максим','Леонидович','3','1980-03-12','Луцк','4800.00','321.00','1980-03-12'),
('7','Петренко','Максим','Леонидович','3','1974-09-17','Киев','7000.00','654.00','1974-09-17'),
('8','Коваленко','Татьяна','Ивановна','3','1966-11-23','Ялта','4000.00','987.00','1966-11-23'),
('11','Петрунько','Максим','Семенович','4','1966-12-04','Киев','1569.00','147.00','1966-12-04'),
('12','Петрашин','Геннадий','Борисович','4','1966-10-23','Киев','3569.00','258.00','1966-10-23'),
('13','Минако','Азар','','5','1965-05-23','Моска','3000.00','550.00','1965-05-23'),
('14','Варламов','Геннадий','Леонидович','5','1963-05-03','Москва','5000.00','350.00','1963-05-03'),
('17','Бобков','Виктор','Борисович','5','1978-07-07','Москва','5698.265','357.00','1978-07-07'),
('18','Петренко','Геннадий','Ибрагимович','6','1978-07-07','Москва','3698.2569','862.00','1978-07-07'),
('19','Варламов','Йоши','Федорович','6','1988-07-07','Луцк','2589.3214','3579.00','1988-07-07'),
('20','Коваленко','Геннадий','Ибрагимович','8','1956-05-11','Луцк','4569.2365','501.00','1956-05-11'),
('21','Мухамед','Ибрагим','','8','1948-10-18','Луцк','1478.2365','123.369','1948-10-18'),
('22','Варламов','Геннадий','Ибрагимович','9','1983-03-07','Ялта','2589.32','321.963','1983-03-07'),
('23','Петренко','Виктор','Ибрагимович','10','1948-07-12','Ялта','3698.3569','569.569','1948-07-12'),
('24','Варламов','Степан','Ибрагимович','11','1968-01-07','Львов','5698.321','789.321','1968-01-07'),
('25','Новиков','Геннадий','Ибрагимович','11','1905-12-07','Львов','5478.53','789.546','1905-12-07');

SET IDENTITY_INSERT Employee OFF;
SET IDENTITY_INSERT Student ON;

insert into Student(StudentId,Surname,Name,Patronymic,Birthday,RecordBook,BirthdayCity,StudyGroupId,Stipendiya) values
('1','Стасюк','Назар','Леонидович','1989-12-05','ІК-11-01','Киев','1','100'),
('2','Сиденко','Катя','Леонидовна','1990-11-06','ІК-11-02','Тернополь','1','200'),
('3','Сиденко','Катя','Леонидовна','1990-10-07','ІК-11-02','Киев','1',''),
('4','Мельниченко','Максим','Леонидович','1990-09-10','ІК-12-01','Чернигов','2','300'),
('5','Карнага','Ярослав','','1990-07-14','ІК-12-03','Киев','2','200'),
('6','Карнага','Ярослава','Игоревня','1990-07-14','ІК-12-03','Москва','2',''),
('7','Волокита','Артем','Николаевич','1992-01-05','ІК-23-01','Киев','3',''),
('8','Саливоненко','Наташа','Анатолиевна','1991-03-09','ІК-23-02','Киев','3','300'),
('9','Краснонос','Наташа','Ивановна','1991-05-12','ІК-24-01','Черкассы','4','741'),
('10','Персиков','Иван','Петрович','1992-07-23','ІК-24-03','Киев','4','300'),
('11','Перончиков','Михаил','','1994-06-12','ІК-24-04','Луцк','4','598'),
('12','Пасичников','Михаил','Петрович','1994-06-12','ІК-24-04','Луцк','4','985'),
('13','Масливець','Артем','Петрович','1994-06-12','ІК-24-04','Киев','4',''),
('14','Карнага','Ярослав','Игоревич','1990-07-14','ІК-12-12','Ялта','2','620'),
('15','Карнага','Станислав','Игоревич','1990-07-14','ІК-12-12','Киев','2',''),
('16','Карнага','Мирослав','','1990-07-14','ІК-12-12','Тертер','4',''),
('21','Назаревич','Назар','Леонидович','1990-12-05','ІК-11-01','Киев','1','635'),
('22','Паничев','Назар','Леонидович','1987-12-05','ІК-11-01','Ялта','1','300'),
('23','Панкоат','Назар','Леонидович','1990-12-05','ІК-11-01','Киев','1','300'),
('24','Панкоат','Назар','Леонидович','1990-12-05','ІК-11-01','Киев','1','500'),
('25','Панкотов','Артем','','1990-12-05','ІК-11-01','Черкассы','1',''),
('26','Панкоат','Назар','Леонидович','1990-12-05','ІК-11-01','Киев','1',''),
('27','Панкотов','Сеня','','1990-12-05','ІК-11-01','Киев','1','500'),
('28','Панко','Назар','Леонидович','1990-12-05','ІК-11-01','Ялта','1','620'),
('29','Пароч','Сеня','','1990-12-05','ІК-11-01','Киев','1',''),
('30','Стасюк','Назар','Леонидович','1989-12-06','ІК-11-56','Киев','1','130');

SET IDENTITY_INSERT Student OFF;

insert into Exam(StudentId,Mark,DcDisciplineId,EmployeeId,DateExam) values
('1','5','1','1','2013-06-01'),
('2','4','1','1','2013-06-01'),
('3','3','1','2','2013-06-01'),
('4','2','1','3','2013-06-01'),
('6','4','1','1','2013-06-01'),
('1','3','2','2','2013-06-05'),
('2','2','2','2','2013-06-05'),
('3','4','2','20','2013-06-05'),
('6','5','2','22','2013-06-05'),
('1','3','3','3','2013-06-07'),
('2','4','3','23','2013-06-07'),
('3','4','3','23','2013-06-07'),
('4','5','3','8','2013-06-07'),
('6','3','3','3','2013-06-07'),
('1','4','1','4','2013-06-09'),
('2','5','4','20','2013-06-09'),
('3','3','4','8','2013-06-09'),
('4','4','4','8','2013-06-09'),
('6','5','4','22','2013-06-09'),
('7','5','5','8','2013-06-02'),
('8','4','5','23','2013-06-02'),
('9','3','5','6','2013-06-02'),--7
('10','2','5','4','2013-06-02'),
('9','4','6','6','2013-06-06'),--7
('10','4','6','6','2013-06-06'),--7
('7','3','7','6','2013-06-10'),--7
('8','4','7','6','2013-06-10'),--7
('9','4','7','6','2013-06-10'),--7
('10','5','7','6','2013-06-01'),--7
('7','4','4','4','2013-06-10'),
('8','5','4','4','2013-06-10'),
('9','3','4','4','2013-06-10'),
('10','4','4','4','2013-06-10'),
('7','5','1','8','2013-06-12'),
('8','4','1','8','2013-06-12'),
('9','3','1','8','2013-06-12'),
('10','2','1','8','2013-06-12'),
('7','4','8','4','2013-06-14'),
('8','3','8','4','2013-06-14'),
('9','5','8','4','2013-06-14'); 